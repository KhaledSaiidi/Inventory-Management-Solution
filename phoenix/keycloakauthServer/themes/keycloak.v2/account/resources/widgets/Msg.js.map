{"version":3,"file":"Msg.js","names":["React","Msg","Component","constructor","props","render","children","localizeWithChildren","msgKey","localize","params","message","l18nMsg","processKey","parts","split","count","Children","map","child","i","undefined","length","forEach","value","index","processParam","replace","startsWith","endsWith","substring","param","key"],"sources":["../../src/app/widgets/Msg.tsx"],"sourcesContent":["/*\n * Copyright 2018 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from 'react';\n\ndeclare const l18nMsg: {[key: string]: string};\n\nexport interface MsgProps {\n    readonly msgKey: string;\n    readonly params?: string[];\n}\n\nexport class Msg extends React.Component<MsgProps> {\n\n    public constructor(props: MsgProps) {\n        super(props);\n    }\n\n    public render(): React.ReactNode {\n        if (this.props.children) {\n            return Msg.localizeWithChildren(this.props.msgKey, this.props.children);\n        }\n        return (\n            <React.Fragment>{Msg.localize(this.props.msgKey, this.props.params)}</React.Fragment>\n        );\n    }\n\n    private static localizeWithChildren(msgKey: string, children: React.ReactNode): React.ReactNode {\n        const message: string = l18nMsg[this.processKey(msgKey)];\n        const parts = message.split(/\\{\\{param_\\d*}}/);\n        const count = React.Children.count(children);\n        return React.Children.map(children, (child, i) =>\n            [parts[i], child, count === i + 1 ? parts[count] : '']\n        );\n    }\n\n    public static localize(msgKey: string, params?: string[]): string {\n        let message: string = l18nMsg[this.processKey(msgKey)];\n        if (message === undefined) message = msgKey;\n\n        if ((params !== undefined) && (params.length > 0)) {\n            params.forEach((value: string, index: number) => {\n                value = this.processParam(value);\n                message = message.replace('{{param_'+ index + '}}', value);\n            })\n        }\n\n        return message;\n    }\n\n    // if the message key has Freemarker syntax, remove it\n    private static processKey(msgKey: string): string {\n        if (!(msgKey.startsWith('${') && msgKey.endsWith('}'))) return msgKey;\n\n        // remove Freemarker syntax\n        return msgKey.substring(2, msgKey.length - 1);\n    }\n\n    // if the param has Freemarker syntax, try to look up its value\n    private static processParam(param: string): string {\n        if (!(param.startsWith('${') && param.endsWith('}'))) return param;\n\n        // remove Freemarker syntax\n        const key: string = param.substring(2, param.length - 1);\n\n        let value: string = l18nMsg[key];\n        if (value === undefined) return param;\n\n        return value;\n    }\n}\n"],"mappings":"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"}