{"version":3,"file":"PermissionSelect.js","names":["React","Select","SelectOption","SelectVariant","Msg","ScopeValue","constructor","value","toString","displayName","name","compareTo","selectOption","PermissionSelect","Component","props","_event","selection","selected","state","onSelect","includes","setState","prevState","filter","item","map","sv","isExpanded","values","s","scopes","option","index","find","render","titleId","direction","typeaheadMulti","localize","onToggle","clearSelection"],"sources":["../../../src/app/content/my-resources-page/PermissionSelect.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport { Select, SelectOption, SelectVariant, SelectOptionObject } from '@patternfly/react-core';\nimport { Scope } from './resource-model';\nimport { Msg } from '../../widgets/Msg';\n\ninterface PermissionSelectState {\n  selected: ScopeValue[];\n  isExpanded: boolean;\n  scopes: JSX.Element[];\n}\n\ninterface PermissionSelectProps {\n  scopes: Scope[];\n  selected?: Scope[];\n  direction?: 'up' | 'down';\n  onSelect: (selected: Scope[]) => void;\n}\n\nclass ScopeValue implements SelectOptionObject {\n  value: Scope;\n  constructor(value: Scope) {\n    this.value = value;\n  }\n\n  toString() {\n    return this.value.displayName ? this.value.displayName : this.value.name;\n  }\n\n  compareTo(selectOption: Scope): boolean {\n    return selectOption.name === this.value.name;\n  }\n}\n\nexport class PermissionSelect extends React.Component<PermissionSelectProps, PermissionSelectState> {\n  constructor(props: PermissionSelectProps) {\n    super(props);\n\n    let values: ScopeValue[] = [];\n    if (this.props.selected) {\n      values = this.props.selected!.map(s => new ScopeValue(s))\n    }\n\n    this.state = {\n      isExpanded: false,\n      selected: values,\n      scopes: this.props.scopes.map((option, index) => (\n        <SelectOption key={index} value={values.find(s => s.compareTo(option)) || new ScopeValue(option)} />\n      ))\n    };\n  }\n\n  private onSelect = (_event: React.MouseEvent | React.ChangeEvent, selection: ScopeValue): void => {\n    const { selected } = this.state;\n    const { onSelect } = this.props;\n    if (selected.includes(selection)) {\n      this.setState(\n        prevState => ({ selected: prevState.selected.filter(item => item !== selection) }),\n        () => onSelect(this.state.selected.map(sv => sv.value))\n      );\n    } else {\n      this.setState(\n        prevState => ({ selected: [...prevState.selected, selection] }),\n        () => onSelect(this.state.selected.map(sv => sv.value))\n      );\n    }\n  }\n\n  private onToggle = (isExpanded: boolean) => {\n    this.setState({\n      isExpanded\n    });\n  }\n\n  private clearSelection = () => {\n    this.setState({\n      selected: [],\n      isExpanded: false\n    });\n    this.props.onSelect([]);\n  };\n\n  render() {\n    const { isExpanded, selected } = this.state;\n    const titleId = 'permission-id';\n\n    return (\n      <div>\n        <span id={titleId} hidden>\n          <Msg msgKey='selectPermissions' />\n        </span>\n        <Select\n          maxHeight={300}\n          direction={this.props.direction || 'down'}\n          variant={SelectVariant.typeaheadMulti}\n          typeAheadAriaLabel={Msg.localize(\"selectPermissions\")}\n          onToggle={this.onToggle}\n          onSelect={this.onSelect}\n          onClear={this.clearSelection}\n          selections={selected}\n          isOpen={isExpanded}\n          aria-labelledby={titleId}\n          placeholderText={Msg.localize(\"selectPermissions\")}\n          menuAppendTo=\"parent\"\n        >\n          {this.state.scopes}\n        </Select>\n      </div>\n    );\n  }\n}\n"],"mappings":"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"}